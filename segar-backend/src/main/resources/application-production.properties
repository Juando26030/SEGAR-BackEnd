# ==============================================================================
# PERFIL DE PRODUCCION - SEGAR Backend
# ==============================================================================
# Este perfil se activa automaticamente cuando se ejecuta con:
# --spring.profiles.active=production
# ==============================================================================

spring.config.activate.on-profile=production

# ==============================================================================
# CONFIGURACION DEL SERVIDOR
# ==============================================================================
spring.application.name=backend
server.port=${SERVER_PORT:8090}

# Configuracion para funcionar detras de un proxy reverso (Nginx con HTTPS)
# Permite que Spring Boot detecte correctamente el protocolo HTTPS
server.forward-headers-strategy=framework
server.tomcat.remoteip.remote-ip-header=x-forwarded-for
server.tomcat.remoteip.protocol-header=x-forwarded-proto

# ==============================================================================
# CONFIGURACION DE KEYCLOAK - PRODUCCION
# ==============================================================================
# Variables de entorno que se pueden sobrescribir en el servidor:
# - KEYCLOAK_AUTH_SERVER_URL
# - KEYCLOAK_ISSUER_URI
# - KEYCLOAK_JWK_SET_URI

spring.security.oauth2.resourceserver.jwt.issuer-uri=${KEYCLOAK_ISSUER_URI:https://segar-solutions.duckdns.org/auth/realms/segar}
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=${KEYCLOAK_JWK_SET_URI:https://segar-solutions.duckdns.org/auth/realms/segar/protocol/openid-connect/certs}

keycloak.auth-server-url=${KEYCLOAK_AUTH_SERVER_URL:https://segar-solutions.duckdns.org/auth}
keycloak.realm=${KEYCLOAK_REALM:segar}
keycloak.admin.client-id=${KEYCLOAK_CLIENT_ID:segar-backend}
keycloak.admin.client-secret=${KEYCLOAK_CLIENT_SECRET:BZp1DSBtfnzfxVuWTQ8SxyZ3SZUY3qo6}

# ==============================================================================
# CONFIGURACION DE BASE DE DATOS H2
# ==============================================================================
spring.jpa.database=h2
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.url=jdbc:h2:file:./segardb;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.username=sa
spring.datasource.password=

# Consola H2 - DESACTIVADA en produccion por seguridad
spring.h2.console.enabled=false

# JPA/Hibernate - Mantener datos en produccion (no borrar tablas)
spring.jpa.generate-ddl=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false

# Desactivar Flyway
spring.flyway.enabled=false
spring.sql.init.mode=never

# ==============================================================================
# CONFIGURACION DE LOGGING
# ==============================================================================
# Nivel de logging apropiado para produccion
logging.level.root=INFO
logging.level.com.segar.backend=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=INFO
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN

# ==============================================================================
# CONFIGURACION DE ARCHIVOS Y UPLOADS
# ==============================================================================
spring.servlet.multipart.max-file-size=${MAX_FILE_SIZE:20MB}
spring.servlet.multipart.max-request-size=${MAX_REQUEST_SIZE:25MB}

# ==============================================================================
# CONFIGURACION SMTP GMAIL
# ==============================================================================
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:soportecasalunaairbnb@gmail.com}
spring.mail.password=${MAIL_PASSWORD:jnki jrix mlsx xvpm}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com

# ==============================================================================
# CONFIGURACION IMAP GMAIL
# ==============================================================================
spring.mail.imap.host=${IMAP_HOST:imap.gmail.com}
spring.mail.imap.port=${IMAP_PORT:993}
spring.mail.imap.username=${IMAP_USERNAME:soportecasalunaairbnb@gmail.com}
spring.mail.imap.password=${IMAP_PASSWORD:jnki jrix mlsx xvpm}

# ==============================================================================
# CONFIGURACION DE SINCRONIZACION DE EMAILS
# ==============================================================================
email.sync.scheduled.enabled=${EMAIL_SYNC_ENABLED:true}
email.sync.scheduled.interval=${EMAIL_SYNC_INTERVAL:300000}
email.sync.on.startup=${EMAIL_SYNC_ON_STARTUP:true}

# ==============================================================================
# CONFIGURACION DE GOOGLE CLOUD PLATFORM
# ==============================================================================
spring.cloud.gcp.enabled=${GCP_ENABLED:false}

# ==============================================================================
# SEGURIDAD - Credenciales de Admin
# ==============================================================================
# IMPORTANTE: Cambiar estas credenciales en produccion real
spring.security.user.name=${ADMIN_USERNAME:admin}
spring.security.user.password=${ADMIN_PASSWORD:admin123}

